<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tenerife Beach Rank + Safety Flags</title>

<style>
:root {
    --bg-color:#f0f4f8;
    --card-bg:#fff;
    --text-main:#333;
    --text-light:#666;
    --green:#2ecc71;
    --yellow:#f1c40f;
    --red:#e74c3c;
    --footer-bg:#000;
}

body {
    font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
    background:var(--bg-color);
    margin:0;
    padding:20px;
    padding-bottom:120px;
}

header { text-align:center; margin-bottom:30px; }
h1 { margin:0; font-size:2rem; }

.subtitle { color:var(--text-light); font-size:.9rem; }
.last-updated { font-size:.8rem; color:#888; font-weight:bold; margin-top:8px; }

.beach-grid {
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(320px,1fr));
    gap:20px;
    max-width:1400px;
    margin:auto;
}

.card {
    background:var(--card-bg);
    border-radius:12px;
    padding:20px;
    border-top:6px solid #ccc;
    box-shadow:0 4px 6px rgba(0,0,0,.05);
}

.card-header { margin-bottom:12px; }

.beach-name { margin:0; font-size:1.1rem; }
.beach-link { color:#2c3e50; text-decoration:none; }
.beach-link:hover { text-decoration:underline; }

.beach-town {
    font-size:.75rem;
    color:#888;
}

.score-badge {
    float:right;
    padding:5px 12px;
    border-radius:20px;
    color:#fff;
    font-weight:bold;
}

.metrics {
    display:grid;
    grid-template-columns:repeat(4,1fr);
    gap:6px;
}

.metric-item {
    background:#f8f9fa;
    padding:8px 4px;
    border-radius:8px;
    text-align:center;
}

.metric-emoji { font-size:1.2rem; }
.metric-label { font-size:.55rem; color:#777; font-weight:bold; }
.metric-value { font-size:.85rem; font-weight:600; }

.status-green { border-color:var(--green); }
.status-green .score-badge { background:var(--green); }
.status-yellow { border-color:var(--yellow); }
.status-yellow .score-badge { background:var(--yellow); color:#333; }
.status-red { border-color:var(--red); }
.status-red .score-badge { background:var(--red); }

.main-footer {
    background:#000;
    color:#fff;
    text-align:center;
    padding:20px;
    position:fixed;
    bottom:0;
    width:100%;
}
</style>
</head>

<body>

<header>
<h1 id="title-text">Tenerife Beach Rank</h1>
<div id="subtitle-text" class="subtitle">Live ranking based on Weather, Wind & Waves</div>
<div id="last-update" class="last-updated">...</div>
</header>

<div id="app" class="beach-grid">
<div class="loading">Loading live data‚Ä¶</div>
</div>

<footer class="main-footer">
¬© 2026 Tenerife Beach Rank
</footer>

<script>
const beaches = [
{ name:"Playa de Las Vistas", town:"Los Cristianos", lat:28.0518, lon:-16.7265 },
{ name:"Playa del Duque", town:"Costa Adeje", lat:28.0908, lon:-16.7431 },
{ name:"Playa de Las Teresitas", town:"Santa Cruz", lat:28.5096, lon:-16.1837 },
{ name:"Playa Jard√≠n", town:"Puerto de la Cruz", lat:28.4168, lon:-16.5574 },
{ name:"Playa de Benijo", town:"Taganana", lat:28.5724, lon:-16.1867 }
];

let globalBeachData = [];

function isNorthBeach(lat) {
    return lat > 28.4;
}

async function fetchWeatherData() {
    const results = await Promise.all(beaches.map(async b => {
        const w = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${b.lat}&longitude=${b.lon}&current=temperature_2m,cloud_cover,wind_speed_10m&wind_speed_unit=kmh`).then(r=>r.json());
        const m = await fetch(`https://marine-api.open-meteo.com/v1/marine?latitude=${b.lat}&longitude=${b.lon}&current=wave_height`).then(r=>r.json());
        return calculateScore({
            ...b,
            temp:w.current.temperature_2m,
            wind:w.current.wind_speed_10m,
            clouds:w.current.cloud_cover,
            wave:m.current.wave_height || 0
        });
    }));
    globalBeachData = results;
    render();
}

function calculateScore(b) {
    let score = 0;

    if (b.temp >= 22 && b.temp <= 30) score += 4;
    else if (b.temp >= 19) score += 2;
    else score += 1;

    if (b.wind < 18) score += 3;
    else if (b.wind < 28) score += 2;
    else score += 1;

    if (b.clouds < 20) score += 3;
    else if (b.clouds < 50) score += 1.5;

    score = Math.round(score);
    let status = score >= 8 ? 'green' : score >= 6 ? 'yellow' : 'red';

    const north = isNorthBeach(b.lat);
    if (b.wave > (north ? 2.5 : 2.0)) status = 'red';
    else if (b.wave > (north ? 1.6 : 1.2) && status === 'green') status = 'yellow';

    return {...b, score, status};
}

function render() {
    const app = document.getElementById('app');
    app.innerHTML = '';

    globalBeachData.sort((a,b)=>b.score-a.score).forEach(b=>{
        app.innerHTML += `
        <div class="card status-${b.status}">
            <div class="card-header">
                <span class="score-badge">${b.score}/10</span>
                <h2 class="beach-name">
                    <a class="beach-link" target="_blank"
                       href="https://www.google.com/maps?q=${b.lat},${b.lon}">
                        ${b.name}
                    </a>
                </h2>
                <div class="beach-town">${b.town} ¬∑ Click beach for Google Maps</div>
            </div>
            <div class="metrics">
                <div class="metric-item">üå°Ô∏è<br>${b.temp}¬∞C</div>
                <div class="metric-item">üå¨Ô∏è<br>${b.wind} km/h</div>
                <div class="metric-item">‚òÅÔ∏è<br>${b.clouds}%</div>
                <div class="metric-item">üåä<br>${b.wave} m</div>
            </div>
        </div>`;
    });

    document.getElementById('last-update').textContent =
        "Last Update: " + new Date().toLocaleTimeString();
}

fetchWeatherData();
</script>
</body>
</html>
